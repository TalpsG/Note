# 查询的并行化

并行和分布式的对比
并行:
- 资源物理距离很近
- 通信速度高
- 通信成本低

分布式可以理解为通信成本很高的并行


## 进程模型 
进程级并行，一个进程一个任务，调度依赖操作系统，进程崩溃不影响数据库。

线程级并行，一个线程一个人物，dbms来进行调度，线程崩溃可能会导致数据库系统的崩溃


## sqlos
sqlos是一个用户级别的os层，运行在dbms里，用来管理os提供的硬件
- 确定哪些任务被调度到哪些线程
- 管理io调度和高级的一些概念比如数据库的逻辑锁

## query并行
inter并行是指查询指令之间并行
intra并行则是指查询指令内部的并行

对于intra-query来说，数据库为每个算子都实现了并行的而版本

### operator
`intra-operator`
水平并行，将数据分为几部分，然后多个线程分别处理一部分数据，之后会合并或是重分等操作

`inter-operator`
`exchange`算子:就是实现重分，合并或者拆分的算子

垂直并行，就是在sql语句的语法树上并行，上下算子分别使用不同的线程处理，类似流水线。


`Bushy`就是将上述二者结合到一起

### 磁盘才是瓶颈
如果磁盘io是瓶颈，那么优化并行实际上并不会让数据库表现更好,反而会让数据库表现更差，因为频繁的切换进程导致的随机访问.

### io并行
多个磁盘组raid,数据库存放在多个磁盘上，对dbms透明。


也可以将表分成多个物理段进行存储。


