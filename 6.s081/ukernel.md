# performance of ukernel system

## abstract
第一代微内核的os太慢且灵活性不高。我们进行了一些实验来验证第二代微内核系统L4 是否 克服了这些问题。实验中L4最大吞吐量仅比Linux小了5%.

## 引言

过去的微内核的抽象层级要么太低要么太高。
太低则需要对内核进行扩展。
太高则系统在特定架构的速度可以很快，但是移植系统的性能损失很大。

本文进行了以下实验来测试L4内核
- Unix宏内核，Linux 可以被当作一个单独的用户服务器运行在L4上层。可以比较原生的Linux性能。

## L4

L4微内核基于线程和地址空间两个概念。IPC是微内核中最基本的机制。RPC远程过程调用可以通过IPC来实现。

地址空间的构建是通过用户级别的服务器pager完成的。只有`grant` `map` `unmap`这三个操作需要kernel实现。当发生`page fault`，pager通过IPC告知发生错误的线程。`page fault`的语义完全由用户程序进行定义。这种方式可以在微内核上实现多种内存管理的方式。

端口映射和地址空间的映射有类似的机制。内核将硬件中断通过IPC传递给对应线程。

异常和`trap`对于线程是同步的。内核仅仅在用户级别反映了他们。
